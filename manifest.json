{
  "name": "hcp-icafix",
  "label": "HCP: ICAFIX Functional Pipeline",
  "description": "Runs ICA-FIX denoising on functional data preprocessed according to the HCP Minimal Preprocessing Pipeline. This Gear is based on scripts from the v4.0-alpha release of the ICAFIX, PostFix, and RestingStateStats pipelines. NOTE: This Gear requires that HCP-STRUCT and HCP-FUNC Gears have been run, as the outputs of those gears are required inputs here. Also note that more than 1 HCP-FUNC output can be provided as input.",
  "author": "Human Connectome Project",
  "maintainer": "Flywheel <support@flywheel.io>",
  "license": "Other",
  "url": "https://github.com/Washington-University/Pipelines",
  "source": "https://github.com/flywheel-apps/hcp-icafix",
  "cite": "(1) G. Salimi-Khorshidi, G. Douaud, C.F. Beckmann, M.F. Glasser, L. Griffanti S.M. Smith. Automatic denoising of functional MRI data: Combining independent component analysis and hierarchical fusion of classifiers. NeuroImage, 90:449-68, 2014 (2) L. Griffanti, G. Salimi-Khorshidi, C.F. Beckmann, E.J. Auerbach, G. Douaud, C.E. Sexton, E. Zsoldos, K. Ebmeier, N. Filippini, C.E. Mackay, S. Moeller, J.G. Xu, E. Yacoub, G. Baselli, K. Ugurbil, K.L. Miller, and S.M. Smith. ICA-based artefact removal and accelerated fMRI acquisition for improved resting state network imaging. NeuroImage, 95:232-47, 2014",
  "version": "test",
  "custom": {
    "gear-builder": {
      "image": "flywheel/hcp-base:0.1.0_4.0.1",
      "category": "analysis"
    },
      "flywheel": {
      "suite": "Human Connectome Project"
    }
  },
  "flywheel": "0",
  "config": {
     "gear-log-level": {
      "default": "INFO",
      "description": "Gear Log verbosity level (ERROR|WARNING|INFO|DEBUG)",
      "type": "string",
      "enum": [
        "ERROR",
        "WARNING",
        "INFO",
        "DEBUG"
      ]
    },

    "TrainingFile": {
      "type": "string",
      "default": "HCP_hp2000.RData",
      "enum": ["HCP_hp2000.RData", 
              "HCP7T_hp2000.RData",
              "HCP_Style_Single_Multirun_Dedrift.RData",
              "NHPHCP_Macaque_RIKEN30SRFIX.RData",
              "Standard.RData",
              "Standard_old.Rdata",
              "UKBiobank.RData",
              "WhII_MB6.RData",
              "WhII_Standard.RData"],
      "description": "Name of FIX training file to use for classification. 'Standard', 'HCP_hp2000', 'HCP7T_hp2000', 'WhII_MB6', 'WhII_Standard', 'UKBiobank'. See https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FIX/UserGuide#Trained-weights_files for details."
    },
    
    "do_motion_regression": {
      "type": "boolean",
      "default": false,
      "description": "set whether or not to regress motion parameters (24 regressors) out of the data as part of FIX (TRUE or FALSE)"
    },
    "HighPassFilter": {
      "type": "integer",
      "default": 2000, 
      "minimum": 1,
      "maximum": 9999,
      "description": "set temporal highpass full-width (2*sigma) to use, in seconds, cannot be 0 for single-run FIX.  For detrending-like behaviour, set <highpass> to 2000"
    },
    "FixThreshold": {
      "type": "integer",
      "default": 10,
      "description": "set FIX threshold (controls sensitivity/specificity tradeoff)"
    },
    "DeleteIntermediates": {
      "type": "boolean",
      "default": false,
      "description": "delete highpass files (note that delete intermediates=TRUE is not recommended for MR+FIX)"
    },
    "Dry-Run": {
        "type":"boolean",
        "default": false,
        "description": "Log all commands, but do not execute."
    }
  },
  "inputs": {
    "api-key": {
        "base": "api-key"
    },
    "functional_zip": {
      "description": "Select functional run for ICA",
      "base": "file",
      "optional": false
    },
   
    "structural_zip": {
      "description": "Select structural zip for the functional data",
      "base": "file",
      "optional": false
    }

  },
  "command": "python3 /flywheel/v0/run.py"
}
